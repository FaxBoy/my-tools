
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>金额最大化购买计算器</title>
  <link rel="stylesheet" href="../assets/style.css">
  <style>
    input, button {margin-top: 6px;}
    .result {margin-top: 20px; background: #fff; border-radius: 8px; padding: 16px;}
  </style>
</head>
<body>
  <header><h2>💵 金额最大化购买计算器</h2></header>
  <main>
    <p>输入金额和商品价格（可输入算式，如 <code>100/2 + 50</code>）</p>
    <div>
      <label>总金额：</label><br>
      <input id="total" type="text" placeholder="如 100*3">
      <br><label>商品A单价：</label><br>
      <input id="priceA" type="text" placeholder="如 9.9*2">
      <br><label>商品B单价：</label><br>
      <input id="priceB" type="text" placeholder="如 15+3">
      <br><label>商品C单价：</label><br>
      <input id="priceC" type="text" placeholder="如 8.5/2">
      <br><button onclick="calculate()">计算</button>
    </div>
    <div class="result" id="result"></div>
  </main>
  <footer><a href="../index.html">← 返回首页</a></footer>
  <script>
    function safeEval(expr) {
      if (!/^[0-9+\-*/().\s]+$/.test(expr)) return NaN;
      try { return Function('"use strict";return(' + expr + ')')(); } catch { return NaN; }
    }
    function calculate() {
      const total = safeEval(document.getElementById('total').value);
      const priceA = safeEval(document.getElementById('priceA').value);
      const priceB = safeEval(document.getElementById('priceB').value);
      const priceC = safeEval(document.getElementById('priceC').value);
      const result = document.getElementById('result');
      const prices = [priceA, priceB, priceC].filter(p => p > 0);
      if (prices.length === 0 || isNaN(total)) return result.innerHTML = "<p>❌ 输入有误</p>";
      let best = {a:0,b:0,c:0,spent:0};
      const maxA = Math.floor(total / (priceA || Infinity));
      for (let a = 0; a <= (isNaN(maxA)?0:maxA); a++) {
        const remainA = total - a*(priceA||0);
        const maxB = Math.floor(remainA / (priceB || Infinity));
        for (let b = 0; b <= (isNaN(maxB)?0:maxB); b++) {
          const remainB = remainA - b*(priceB||0);
          const c = priceC > 0 ? Math.floor(remainB / priceC) : 0;
          const spent = a*(priceA||0) + b*(priceB||0) + c*(priceC||0);
          if (spent > best.spent && spent <= total)
            best = {a,b,c,spent};
        }
      }
      const left = (total - best.spent).toFixed(2);
      result.innerHTML = `
        <h3>✅ 可用金额最大化使用：￥${best.spent.toFixed(2)}（剩余￥${left}）</h3>
        <p>商品A：${best.a} 件 × ￥${priceA || 0} = ￥${(best.a*(priceA||0)).toFixed(2)}</p>
        <p>商品B：${best.b} 件 × ￥${priceB || 0} = ￥${(best.b*(priceB||0)).toFixed(2)}</p>
        <p>商品C：${best.c} 件 × ￥${priceC || 0} = ￥${(best.c*(priceC||0)).toFixed(2)}</p>`;
    }
  </script>
</body>
</html>
